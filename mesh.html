<template>
<div class="nodes-container pa-4 rounded-lg" style="background-color: #a2af9b;">
    <div
        v-for="(mesh, index) in mesh_list"
        :key="index"
        class="mesh-item"
    >
        <v-container>
    <v-dialog
      transition="dialog-bottom-transition"
      width="auto"
    >
      <template v-slot:activator="{ props: activatorProps }">
        <v-btn
            v-bind="activatorProps"
            class="pt-2 pb-2"
            color="primary"
            outlined
        >
            <div class="mr-4 text-left">
                <p class="text-h6 font-weight-bold" style="color:#415936">Mesh Name: {{ mesh.mesh_name }}</p>
                <p class="text-subtitle-2">IP Addr: {{ mesh.ip_address }}</p>
            </div>
        </v-btn>
      </template>
      <template v-slot:default="{ isActive }">
        <v-card>
          <v-toolbar title="Opening from the Top"></v-toolbar>
          <v-card-text class="text-h2 pa-12">
            Hello world!
          </v-card-text>
          <v-card-actions class="justify-end">
            <v-btn
              text="Close"
              @click="isActive.value = false"
            ></v-btn>
          </v-card-actions>
        </v-card>
      </template>
    </v-dialog>
  </v-container>
    </div>
  </div>
</template>
<script>
export default {
  mounted() {
    if (localStorage.getItem("loggedIn") === "false") {
        this.redirectLogin();
    }
    const sendObj = {
        collection: "mesh",
        payload: { username: this.username },
        operation: "find.toArray"
      };
    this.send(sendObj);
  },
  data() {
    return {
      mesh_list: {}
    };
  },
  watch: {
    msg(newMsg) {
        // receive mesh api
        if (newMsg && typeof newMsg === "object") {
            this.mesh_list = newMsg.payload;
        }
    }
  },
  methods: {
    redirectLogin() {
      const base = window.location.origin;
      window.location.href = `${base}/dashboard/login`;
    }
  }
};
</script>